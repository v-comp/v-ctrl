{"version":3,"file":"index.esm.js","sources":["../src/index.js"],"sourcesContent":["import throttle from 'lodash/throttle'\nimport clamp from 'lodash/clamp'\nimport isEqual from 'lodash/isEqual'\n\nconst toPrecision = function (num, precision) {\n  const p = precision | 0\n  return p > 0 ? parseFloat(num.toFixed(p)) : num\n}\n\nconst VueCtrlComponent = {\n  name: 'v-ctrl',\n  abstract: true,\n  props: {\n    direction: {\n      type: String,\n      default: 'h',\n      validator (val) {\n        return ['v', 'h', 'vh', 'hv'].indexOf(val) > -1\n      }\n    },\n    throttle: {\n      type: Number,\n      default: 80\n    },\n    precision: {\n      type: Number\n    }\n  },\n\n  methods: {\n    msdown (e) {\n      e.preventDefault()\n      document.addEventListener('mousemove', this.msmove)\n      document.addEventListener('mouseup', this.msup)\n      this.next(e)\n    },\n  \n    msmove (e) {\n      e.preventDefault()\n      this.next(e)\n    },\n  \n    msup (e) {\n      this.next(e)\n      document.removeEventListener('mousemove', this.msmove)\n      document.removeEventListener('mouseup', this.msup)\n    },\n  \n    notify (val) {\n      if (isEqual(this.memo, val) === false) {\n        this.memo = val\n        this.$emit('change', val)\n      }\n    },\n\n    next ({ clientX = 0, clientY = 0 } = {}) {\n      const { direction, adjust } = this\n      const rect = this.$el.getBoundingClientRect()\n\n      const { left, width } = rect\n      const deltaX = clientX - left\n      const x = adjust(deltaX / width)\n\n      if (direction === 'h') {\n        return this.notify(x)\n      }\n  \n      const { top, height } = rect\n      const deltaY = clientY - top\n      const y = adjust(deltaY / height)\n\n      if (direction === 'v') {\n        return this.notify(y)\n      }\n\n      // both direction\n      this.notify([x, y])\n    },\n\n    adjust (num) {\n      return toPrecision(clamp(num, 0, 1), this.precision)\n    }\n  },\n\n  render (h) {\n    return this.$slots.default[0]\n  },\n\n  created () {\n    const { msdown, msmove } = this\n\n    this.msdown = msdown.bind(this)\n    this.msmove = throttle(msmove.bind(this), this.throttle)\n\n    this.memo = null\n  },\n\n  mounted () {\n    this.$el.addEventListener('mousedown', this.msdown)\n  },\n\n  destroyed () {\n    this.$el.removeEventListener('mousedown', this.msdown)\n  },\n\n  install () {\n    Vue.component(VueCtrlComponent.name, VueCtrlComponent)\n  }\n}\n\nif (typeof window !== 'undefined' && window.Vue) {\n  Vue.use(VueCtrlComponent)\n}\n\nexport default { VueCtrlComponent }\n"],"names":["const"],"mappings":"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"}